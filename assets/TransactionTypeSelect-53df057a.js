import{r as s,O as Vt,x as re,M as ne,D as Me,Z as At,w as St,K as O,P as ze,y as De,a2 as $t,C as Ft,S as Wt,z as jt,h as ft,Y as Ut,ak as zt,al as Qt,E as M,am as Gt,an as Xt,d as qe,ao as vt,j as Je}from"./index-42a4afd0.js";import{u as Bt,a as Yt,B as qt,g as Jt}from"./index-5763a348.js";import{T as Zt,c as er,e as Ze,r as tr,S as rr,d as nr}from"./Select-561e3632.js";import{u as ht}from"./useMergedState-58b942e0.js";import{K as Ne}from"./KeyCode-6413d982.js";import{z as pt}from"./index-b5c30253.js";var It=s.createContext(null),Et=s.createContext(null);function ar(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function ir(e){var t=e||{},a=t.label,r=t.value,i=t.children,c=r||"value";return{_title:a?[a]:["title","label"],value:c,key:c,children:i||"children"}}function et(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function or(e,t){var a=[];function r(i){i.forEach(function(c){a.push(c[t.value]);var n=c[t.children];n&&r(n)})}return r(e),a}function gt(e){return e==null}var lr={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},cr=function(t,a){var r=Bt(),i=r.prefixCls,c=r.multiple,n=r.searchValue,l=r.toggleOpen,o=r.open,u=r.notFoundContent,d=s.useContext(Et),x=d.virtual,C=d.listHeight,S=d.listItemHeight,D=d.treeData,b=d.fieldNames,z=d.onSelect,H=d.dropdownMatchSelectWidth,p=s.useContext(It),L=p.checkable,E=p.checkedKeys,B=p.halfCheckedKeys,Y=p.treeExpandedKeys,V=p.treeDefaultExpandAll,Pe=p.treeDefaultExpandedKeys,q=p.onTreeExpand,A=p.treeIcon,_e=p.showTreeIcon,J=p.switcherIcon,ve=p.treeLine,ae=p.treeNodeFilterProp,he=p.loadData,ie=p.treeLoadedKeys,pe=p.treeMotion,_=p.onTreeLoad,ge=p.keyEntities,R=s.useRef(),oe=Vt(function(){return D},[o,D],function(w,N){return N[0]&&w[1]!==N[1]}),me=s.useMemo(function(){return L?{checked:E,halfChecked:B}:null},[L,E,B]);s.useEffect(function(){if(o&&!c&&E.length){var w;(w=R.current)===null||w===void 0||w.scrollTo({key:E[0]})}},[o]);var Q=String(n).toLowerCase(),ye=function(N){return Q?String(N[ae]).toLowerCase().includes(Q):!1},le=s.useState(Pe),ce=re(le,2),$=ce[0],Ce=ce[1],se=s.useState(null),ue=re(se,2),Z=ue[0],Se=ue[1],Ie=s.useMemo(function(){return Y?ne(Y):n?Z:$},[$,Z,Y,n]);s.useEffect(function(){n&&Se(or(D,b))},[n]);var Ge=function(N){Ce(N),Se(N),q&&q(N)},de=function(N){N.preventDefault()},ee=function(N,X){var W=X.node;L&&et(W)||(z(W.key,{selected:!E.includes(W.key)}),c||l(!1))},Re=s.useState(null),F=re(Re,2),I=F[0],Xe=F[1],G=ge[I];if(s.useImperativeHandle(a,function(){var w;return{scrollTo:(w=R.current)===null||w===void 0?void 0:w.scrollTo,onKeyDown:function(X){var W,P=X.which;switch(P){case Ne.UP:case Ne.DOWN:case Ne.LEFT:case Ne.RIGHT:(W=R.current)===null||W===void 0||W.onKeyDown(X);break;case Ne.ENTER:{if(G){var j=(G==null?void 0:G.node)||{},Ve=j.selectable,Ae=j.value;Ve!==!1&&ee(null,{node:{key:I},selected:!E.includes(Ae)})}break}case Ne.ESC:l(!1)}},onKeyUp:function(){}}}),oe.length===0)return s.createElement("div",{role:"listbox",className:"".concat(i,"-empty"),onMouseDown:de},u);var Ee={fieldNames:b};return ie&&(Ee.loadedKeys=ie),Ie&&(Ee.expandedKeys=Ie),s.createElement("div",{onMouseDown:de},G&&o&&s.createElement("span",{style:lr,"aria-live":"assertive"},G.node.value),s.createElement(Zt,Me({ref:R,focusable:!1,prefixCls:"".concat(i,"-tree"),treeData:oe,height:C,itemHeight:S,virtual:x!==!1&&H!==!1,multiple:c,icon:A,showIcon:_e,switcherIcon:J,showLine:ve,loadData:n?null:he,motion:pe,activeKey:I,checkable:L,checkStrictly:!0,checkedKeys:me,selectedKeys:L?[]:E,defaultExpandAll:V},Ee,{onActiveChange:Xe,onSelect:ee,onCheck:ee,onExpand:Ge,onLoad:_,filterTreeNode:ye})))},Tt=s.forwardRef(cr);Tt.displayName="OptionList";var rt=function(){return null},wt="SHOW_ALL",nt="SHOW_PARENT",Qe="SHOW_CHILD";function mt(e,t,a,r){var i=new Set(e);return t===Qe?e.filter(function(c){var n=a[c];return!(n&&n.children&&n.children.some(function(l){var o=l.node;return i.has(o[r.value])})&&n.children.every(function(l){var o=l.node;return et(o)||i.has(o[r.value])}))}):t===nt?e.filter(function(c){var n=a[c],l=n?n.parent:null;return!(l&&!et(l.node)&&i.has(l.key))}):e}var sr=["children","value"];function xt(e){return At(e).map(function(t){if(!s.isValidElement(t)||!t.type)return null;var a=t.key,r=t.props,i=r.children,c=r.value,n=St(r,sr),l=O({key:a,value:c},n),o=xt(i);return o.length&&(l.children=o),l}).filter(function(t){return t})}function tt(e){if(!e)return e;var t=O({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return ze(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),t}}),t}function ur(e,t,a,r,i,c){var n=null,l=null;function o(){function u(d){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return d.map(function(S,D){var b="".concat(x,"-").concat(D),z=S[c.value],H=a.includes(z),p=u(S[c.children]||[],b,H),L=s.createElement(rt,S,p.map(function(B){return B.node}));if(t===z&&(n=L),H){var E={pos:b,node:L,children:p};return C||l.push(E),E}return null}).filter(function(S){return S})}l||(l=[],u(r),l.sort(function(d,x){var C=d.node.props.value,S=x.node.props.value,D=a.indexOf(C),b=a.indexOf(S);return D-b}))}Object.defineProperty(e,"triggerNode",{get:function(){return ze(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),o(),n}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return ze(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),o(),i?l:l.map(function(d){var x=d.node;return x})}})}function dr(e,t){var a=t.id,r=t.pId,i=t.rootPId,c={},n=[],l=e.map(function(o){var u=O({},o),d=u[a];return c[d]=u,u.key=u.key||d,u});return l.forEach(function(o){var u=o[r],d=c[u];d&&(d.children=d.children||[],d.children.push(o)),(u===i||!d&&i===null)&&n.push(o)}),n}function fr(e,t,a){return s.useMemo(function(){return e?a?dr(e,O({id:"id",pId:"pId",rootPId:null},a!==!0?a:{})):e:xt(t)},[t,a,e])}const vr=function(e){var t=s.useRef({valueLabels:new Map});return s.useMemo(function(){var a=t.current.valueLabels,r=new Map,i=e.map(function(c){var n,l=c.value,o=(n=c.label)!==null&&n!==void 0?n:a.get(l);return r.set(l,o),O(O({},c),{},{label:o})});return t.current.valueLabels=r,[i]},[e])};function yt(e){var t=s.useRef();t.current=e;var a=s.useCallback(function(){return t.current.apply(t,arguments)},[]);return a}const hr=function(e,t){return s.useMemo(function(){var a=er(e,{fieldNames:t,initWrapper:function(i){return O(O({},i),{},{valueEntities:new Map})},processEntity:function(i,c){var n=i.node[t.value];c.valueEntities.set(n,i)}});return a},[e,t])},pr=function(e,t,a,r){return s.useMemo(function(){var i=e.map(function(o){var u=o.value;return u}),c=t.map(function(o){var u=o.value;return u}),n=i.filter(function(o){return!r[o]});if(a){var l=Ze(i,!0,r);i=l.checkedKeys,c=l.halfCheckedKeys}return[Array.from(new Set([].concat(ne(n),ne(i)))),c]},[e,t,a,r])},gr=function(e,t,a){var r=a.treeNodeFilterProp,i=a.filterTreeNode,c=a.fieldNames,n=c.children;return s.useMemo(function(){if(!t||i===!1)return e;var l;if(typeof i=="function")l=i;else{var o=t.toUpperCase();l=function(x,C){var S=C[r];return String(S).toUpperCase().includes(o)}}function u(d){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return d.map(function(C){var S=C[n],D=x||l(t,tt(C)),b=u(S||[],D);return D||b.length?O(O({},C),{},De({},n,b)):null}).filter(function(C){return C})}return u(e)},[e,t,n,r,i])};var mr=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","virtual","listHeight","listItemHeight","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"];function yr(e){return!e||$t(e)!=="object"}var Cr=s.forwardRef(function(e,t){var a=e.id,r=e.prefixCls,i=r===void 0?"rc-tree-select":r,c=e.value,n=e.defaultValue,l=e.onChange,o=e.onSelect,u=e.onDeselect,d=e.searchValue,x=e.inputValue,C=e.onSearch,S=e.autoClearSearchValue,D=S===void 0?!0:S,b=e.filterTreeNode,z=e.treeNodeFilterProp,H=z===void 0?"value":z,p=e.showCheckedStrategy,L=p===void 0?Qe:p,E=e.treeNodeLabelProp,B=e.multiple,Y=e.treeCheckable,V=e.treeCheckStrictly,Pe=e.labelInValue,q=e.fieldNames,A=e.treeDataSimpleMode,_e=e.treeData,J=e.children,ve=e.loadData,ae=e.treeLoadedKeys,he=e.onTreeLoad,ie=e.treeDefaultExpandAll,pe=e.treeExpandedKeys,_=e.treeDefaultExpandedKeys,ge=e.onTreeExpand,R=e.virtual,oe=e.listHeight,me=oe===void 0?200:oe,Q=e.listItemHeight,ye=Q===void 0?20:Q,le=e.onDropdownVisibleChange,ce=e.dropdownMatchSelectWidth,$=ce===void 0?!0:ce,Ce=e.treeLine,se=e.treeIcon,ue=e.showTreeIcon,Z=e.switcherIcon,Se=e.treeMotion,Ie=St(e,mr),Ge=Yt(a),de=Y&&!V,ee=Y||V,Re=V||Pe,F=ee||B,I=s.useMemo(function(){return ir(q)},[JSON.stringify(q)]),Xe=ht("",{value:d!==void 0?d:x,postState:function(f){return f||""}}),G=re(Xe,2),Ee=G[0],w=G[1],N=function(f){w(f),C==null||C(f)},X=fr(_e,J,A),W=hr(X,I),P=W.keyEntities,j=W.valueEntities,Ve=s.useCallback(function(v){var f=[],h=[];return v.forEach(function(m){j.has(m)?h.push(m):f.push(m)}),{missingRawValues:f,existRawValues:h}},[j]),Ae=gr(X,Ee,{fieldNames:I,treeNodeFilterProp:H,filterTreeNode:b}),at=s.useCallback(function(v){if(v){if(E)return v[E];for(var f=I._title,h=0;h<f.length;h+=1){var m=v[f[h]];if(m!==void 0)return m}}},[I,E]),$e=s.useCallback(function(v){var f=ar(v);return f.map(function(h){return yr(h)?{value:h}:h})},[]),Fe=s.useCallback(function(v){var f=$e(v);return f.map(function(h){var m=h.label,K=h.value,T=h.halfChecked,g,y=j.get(K);if(y){var k;m=(k=m)!==null&&k!==void 0?k:at(y.node),g=y.node.disabled}return{label:m,value:K,halfChecked:T,disabled:g}})},[j,at,$e]),bt=ht(n,{value:c}),it=re(bt,2),ot=it[0],Nt=it[1],lt=s.useMemo(function(){return $e(ot)},[$e,ot]),kt=s.useMemo(function(){var v=[],f=[];return lt.forEach(function(h){h.halfChecked?f.push(h):v.push(h)}),[v,f]},[lt]),ct=re(kt,2),Te=ct[0],st=ct[1],ut=s.useMemo(function(){return Te.map(function(v){return v.value})},[Te]),Dt=pr(Te,st,de,P),dt=re(Dt,2),we=dt[0],We=dt[1],Lt=s.useMemo(function(){var v=mt(we,L,P,I),f=v.map(function(T){var g,y,k;return(g=(y=P[T])===null||y===void 0||(k=y.node)===null||k===void 0?void 0:k[I.value])!==null&&g!==void 0?g:T}),h=f.map(function(T){var g=Te.find(function(y){return y.value===T});return{value:T,label:g==null?void 0:g.label}}),m=Fe(h),K=m[0];return!F&&K&&gt(K.value)&&gt(K.label)?[]:m.map(function(T){var g;return O(O({},T),{},{label:(g=T.label)!==null&&g!==void 0?g:T.value})})},[I,F,we,Te,Fe,L,P]),Pt=vr(Lt),_t=re(Pt,1),Kt=_t[0],je=yt(function(v,f,h){var m=Fe(v);if(Nt(m),D&&w(""),l){var K=v;if(de){var T=mt(v,L,P,I);K=T.map(function(U){var te=j.get(U);return te?te.node[I.value]:U})}var g=f||{triggerValue:void 0,selected:void 0},y=g.triggerValue,k=g.selected,xe=K;if(V){var Ye=st.filter(function(U){return!K.includes(U.value)});xe=[].concat(ne(xe),ne(Ye))}var Ke=Fe(xe),fe={preValue:Te,triggerValue:y},be=!0;(V||h==="selection"&&!k)&&(be=!1),ur(fe,y,v,X,be,I),ee?fe.checked=k:fe.selected=k;var Ue=Re?Ke:Ke.map(function(U){return U.value});l(F?Ue:Ue[0],Re?null:Ke.map(function(U){return U.label}),fe)}}),Be=s.useCallback(function(v,f){var h,m=f.selected,K=f.source,T=P[v],g=T==null?void 0:T.node,y=(h=g==null?void 0:g[I.value])!==null&&h!==void 0?h:v;if(!F)je([y],{selected:!0,triggerValue:y},"option");else{var k=m?[].concat(ne(ut),[y]):we.filter(function(te){return te!==y});if(de){var xe=Ve(k),Ye=xe.missingRawValues,Ke=xe.existRawValues,fe=Ke.map(function(te){return j.get(te).key}),be;if(m){var Ue=Ze(fe,!0,P);be=Ue.checkedKeys}else{var U=Ze(fe,{checked:!1,halfCheckedKeys:We},P);be=U.checkedKeys}k=[].concat(ne(Ye),ne(be.map(function(te){return P[te].node[I.value]})))}je(k,{selected:m,triggerValue:y},K||"option")}m||!F?o==null||o(y,tt(g)):u==null||u(y,tt(g))},[Ve,j,P,I,F,ut,je,de,o,u,we,We]),Mt=s.useCallback(function(v){if(le){var f={};Object.defineProperty(f,"documentClickClose",{get:function(){return ze(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),le(v,f)}},[le]),Ot=yt(function(v,f){var h=v.map(function(m){return m.value});if(f.type==="clear"){je(h,{},"selection");return}f.values.length&&Be(f.values[0].value,{selected:!1,source:"selection"})}),Ht=s.useMemo(function(){return{virtual:R,dropdownMatchSelectWidth:$,listHeight:me,listItemHeight:ye,treeData:Ae,fieldNames:I,onSelect:Be}},[R,$,me,ye,Ae,I,Be]),Rt=s.useMemo(function(){return{checkable:ee,loadData:ve,treeLoadedKeys:ae,onTreeLoad:he,checkedKeys:we,halfCheckedKeys:We,treeDefaultExpandAll:ie,treeExpandedKeys:pe,treeDefaultExpandedKeys:_,onTreeExpand:ge,treeIcon:se,treeMotion:Se,showTreeIcon:ue,switcherIcon:Z,treeLine:Ce,treeNodeFilterProp:H,keyEntities:P}},[ee,ve,ae,he,we,We,ie,pe,_,ge,se,Se,ue,Z,Ce,H,P]);return s.createElement(Et.Provider,{value:Ht},s.createElement(It.Provider,{value:Rt},s.createElement(qt,Me({ref:t},Ie,{id:Ge,prefixCls:i,mode:F?"multiple":void 0,displayValues:Kt,onDisplayValuesChange:Ot,searchValue:Ee,onSearch:N,OptionList:Tt,emptyOptions:!X.length,onDropdownVisibleChange:Mt,dropdownMatchSelectWidth:$}))))}),Oe=Cr;Oe.TreeNode=rt;Oe.SHOW_ALL=wt;Oe.SHOW_PARENT=nt;Oe.SHOW_CHILD=Qe;var Sr=globalThis&&globalThis.__rest||function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(a[r[i]]=e[r[i]]);return a},Ir=function(t,a){var r,i=t.prefixCls,c=t.size,n=t.bordered,l=n===void 0?!0:n,o=t.className,u=t.treeCheckable,d=t.multiple,x=t.listHeight,C=x===void 0?256:x,S=t.listItemHeight,D=S===void 0?26:S,b=t.notFoundContent,z=t.switcherIcon,H=t.treeLine,p=t.getPopupContainer,L=t.dropdownClassName,E=t.treeIcon,B=E===void 0?!1:E,Y=t.transitionName,V=t.choiceTransitionName,Pe=V===void 0?"":V,q=Sr(t,["prefixCls","size","bordered","className","treeCheckable","multiple","listHeight","listItemHeight","notFoundContent","switcherIcon","treeLine","getPopupContainer","dropdownClassName","treeIcon","transitionName","choiceTransitionName"]),A=s.useContext(Ft),_e=A.getPopupContainer,J=A.getPrefixCls,ve=A.renderEmpty,ae=A.direction,he=A.virtual,ie=A.dropdownMatchSelectWidth,pe=s.useContext(Wt);jt(d!==!1||!u,"TreeSelect","`multiple` will always be `true` when `treeCheckable` is true");var _=J("select",i),ge=J("select-tree",i),R=J("tree-select",i),oe=ft(L,"".concat(R,"-dropdown"),De({},"".concat(R,"-dropdown-rtl"),ae==="rtl")),me=!!(u||d),Q=Jt(Me(Me({},q),{multiple:me,prefixCls:_})),ye=Q.suffixIcon,le=Q.removeIcon,ce=Q.clearIcon,$;b!==void 0?$=b:$=ve("Select");var Ce=Ut(q,["suffixIcon","itemIcon","removeIcon","clearIcon","switcherIcon"]),se=c||pe,ue=ft(!i&&R,(r={},De(r,"".concat(_,"-lg"),se==="large"),De(r,"".concat(_,"-sm"),se==="small"),De(r,"".concat(_,"-rtl"),ae==="rtl"),De(r,"".concat(_,"-borderless"),!l),r),o),Z=J();return s.createElement(Oe,Me({virtual:he,dropdownMatchSelectWidth:ie},Ce,{ref:a,prefixCls:_,className:ue,listHeight:C,listItemHeight:D,treeCheckable:u&&s.createElement("span",{className:"".concat(_,"-tree-checkbox-inner")}),treeLine:!!H,inputIcon:ye,multiple:d,removeIcon:le,clearIcon:ce,switcherIcon:function(Ie){return tr(ge,z,H,Ie)},showTreeIcon:B,notFoundContent:$,getPopupContainer:p||_e,treeMotion:null,dropdownClassName:oe,choiceTransitionName:pt(Z,"",Pe),transitionName:pt(Z,"slide-up",Y)}))},Er=s.forwardRef(Ir),He=Er;He.TreeNode=rt;He.SHOW_ALL=wt;He.SHOW_PARENT=nt;He.SHOW_CHILD=Qe;const Tr=He;class Le{constructor(){this._localDataService=zt(),this.create=t=>new Promise(a=>{var i,c,n;const r=this._localDataService.categories;r.push({id:Qt(),isActive:t.isActive?t.isActive:!0,mpath:"",name:t.name?t.name:"",order:t.order?t.order:0,parentCategoryId:(i=t.parentCategory)!=null&&i.id?t.parentCategory.id:null,typeId:(c=t.type)!=null&&c.id?(n=t.type)==null?void 0:n.id:M.EXPENSE}),this._localDataService.categories=r.sort((l,o)=>l.order-o.order),a()}),this.delete=t=>new Promise((a,r)=>{const i=this._localDataService.categories,c=i.findIndex(o=>o.id===t);if(c===-1){r("category delete, id not found:"+t);return}const l=this._localDataService.transactions.filter(o=>o.categoryId===t);l.length?(alert(`Счет сделан неактивным, а не удалён, т.к. по счету были найдены транзакции. 
Даты:
`+l.map(o=>Gt(o.dt)).join(`
`)),i[c].isActive=!1):(console.log("category delete",c),i.splice(c,1)),this._localDataService.categories=i,a()}),this.getOne=t=>this._localDataService.categories.find(r=>r.id===t),this.getTree=(t,a)=>new Promise(r=>{const c=this._localDataService.categories.filter(o=>{let u=!0;if(t){let d=t;t===M.RETURN_EXPENSE&&(d=M.EXPENSE),t===M.RETURN_INCOME&&(d=M.INCOME),o.typeId!==d&&(u=!1)}return!a&&!o.isActive&&(u=!1),u}),l=c.filter(o=>o.parentCategoryId===null).map(o=>{const u=c.filter(d=>o.id===d.parentCategoryId).map(d=>this.transformCategoryToTreeItem(d));return{...this.transformCategoryToTreeItem(o),children:u}});r(l)}),this.transformCategoryToTreeItem=t=>({id:t.id,key:t.id,value:t.id,isActive:t.isActive,title:t.name}),this.update=(t,a)=>new Promise((r,i)=>{const c=this._localDataService.categories,n=c.findIndex(l=>l.id===t);if(n===-1){console.error("categoryToUpdateIdx not found",t,a),i();return}c.splice(n,1),c.push({...a,id:t}),this._localDataService.categories=c.sort((l,o)=>l.order-o.order),r()})}static getInstance(){return Le.instance||(Le.instance=new Le),Le.instance}}const wr=()=>Le.getInstance(),ke="categories",xr=()=>{const e=Xt(),t=wr();return{useCreate:()=>vt(n=>t.create(n),{onSuccess:()=>{e.invalidateQueries(ke)}}),useGetTree:n=>{const{typeId:l,showHidden:o}=n;return qe([ke,"tree",l,o],()=>t.getTree(l,o))},useGetOne:n=>qe([ke,n],()=>t.getOne(n),{enabled:!!n}),useItem:(n,l,o)=>vt(u=>n==="PUT"?t.update(l,u):t.delete(l),{onSuccess:async()=>{console.log("useItem onSuccess",n),await e.cancelQueries(ke),e.invalidateQueries([ke,l]),e.invalidateQueries(ke),o&&o()}})}},Or=({typeId:e,onChange:t,value:a,allowClear:r,disabled:i})=>{const{isLoading:c,data:n}=xr().useGetTree({typeId:e});return Je.jsx(Tr,{treeData:n,allowClear:r,loading:c,disabled:i||!e,onChange:t,value:a!=0?a:void 0,dropdownStyle:{overflow:"auto"},treeDefaultExpandAll:!0})},br="transactionTypes",Ct=[{id:M.EXPENSE,name:"Расход"},{id:M.INCOME,name:"Доход"},{id:M.RETURN_EXPENSE,name:"Возврат расхода"},{id:M.RETURN_INCOME,name:"Возврат дохода"},{id:M.TRANSFER,name:"Перевод между своими счетами"}],Nr=e=>new Promise(t=>{t(e?Ct.filter(a=>a.id!==M.RETURN_EXPENSE&&a.id!==M.RETURN_INCOME):Ct)}),kr=e=>qe([br,e],()=>Nr(!!e)),Hr=({allowClear:e,value:t,hideReturns:a,disabled:r,onChange:i})=>{const{isLoading:c,data:n}=kr(a);return Je.jsx(rr,{allowClear:e,loading:c,onChange:i,value:t,disabled:r,children:(n==null?void 0:n.length)&&(n==null?void 0:n.map(l=>Je.jsx(nr,{value:l.id,children:l.name},l.id)))})};export{Or as C,Hr as T,xr as u};
