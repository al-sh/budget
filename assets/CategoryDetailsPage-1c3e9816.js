import{a as I,r as j,j as e,U as d,B as h,b as C,L as T}from"./index-42a4afd0.js";import{u,T as f,C as E}from"./TransactionTypeSelect-53df057a.js";import{F as b}from"./FormHeader-b04ff8d9.js";import{F as s}from"./index-b5c30253.js";import{I as m}from"./index-b0aedb36.js";import{C as v}from"./index-eb228f41.js";import"./index-5763a348.js";import"./useMergedState-58b942e0.js";import"./KeyCode-6413d982.js";import"./Select-561e3632.js";const y=({category:t})=>{const{useItem:i}=u(),r=i("PUT",t.id),n=i("DELETE",t.id),a=I(),[o]=s.useForm(),l=t.typeId,[p,c]=j.useState(l);return e.jsxs("div",{children:[e.jsx(b,{text:"Редактирование категории",onDeleteButtonClick:()=>{confirm("Удалить категорию? При наличии транзакций категория будет скрыта.")&&(n.mutate({id:t.id}),a(d.SETTINGS.CATEGORIES))}}),e.jsxs(s,{name:"basic",labelCol:{span:8},layout:"vertical",form:o,wrapperCol:{span:16},initialValues:{...t,isActive:t!=null&&t.id?t.isActive:!0,typeId:l},onValuesChange:()=>{c(o.getFieldValue("typeId"))},onFinish:x=>{r.mutate(x),a(d.SETTINGS.CATEGORIES)},autoComplete:"off",children:[e.jsx(s.Item,{label:"Название",name:"name",rules:[{message:"Введите название категории",required:!0}],children:e.jsx(m,{})}),e.jsx(s.Item,{label:"Тип",name:"typeId",rules:[{message:"Укажите тип категории",required:!0}],children:e.jsx(f,{hideReturns:!0,disabled:!0})}),e.jsx(s.Item,{label:"Родительская категория",name:"parentCategoryId",children:e.jsx(E,{typeId:p,allowClear:!0})}),e.jsx(s.Item,{label:"Порядок",name:"order",children:e.jsx(m,{type:"number"})}),e.jsx(s.Item,{name:"isActive",valuePropName:"checked",children:e.jsx(v,{children:"Активна"})}),e.jsx(s.Item,{wrapperCol:{offset:8,span:16},children:e.jsx(h,{type:"primary",htmlType:"submit",disabled:r.isLoading,children:"Сохранить"})})]}),r.isLoading&&e.jsx("div",{children:"Сохранение данных..."})]})},U=()=>{const{categoryId:t}=C(),{useGetOne:i}=u(),{isFetching:r,isError:n,data:a}=i(t||"");return e.jsxs(e.Fragment,{children:[r&&e.jsx(T,{}),n&&!r&&e.jsx("div",{children:"Ошибка загрузки категории"}),!r&&!n&&a&&e.jsx(y,{category:a})]})};export{U as CategoryDetailsPage,U as default};
