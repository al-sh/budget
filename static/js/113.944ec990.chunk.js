"use strict";(self.webpackChunkbudget_react=self.webpackChunkbudget_react||[]).push([[113],{3570:function(e,n,t){t.d(n,{$:function(){return o},P:function(){return i}});var r=t(6818),a=t(184),i=function(e){var n=e.allowClear,t=e.children,i=e.disabled,o=e.loading,u=e.value,c=e.onChange;return(0,a.jsx)(r.Z,{allowClear:n,disabled:i,loading:o,value:0!=u?u:void 0,onChange:c,children:t})},o=function(e){var n=e.children;return(0,a.jsx)(r.Z.Option,{children:n})}},5461:function(e,n,t){t.d(n,{p:function(){return m}});var r=t(168),a=t(5751),i=t(1413),o=t(2791),u={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},c=t(4291),l=function(e,n){return o.createElement(c.Z,(0,i.Z)((0,i.Z)({},e),{},{ref:n,icon:u}))};l.displayName="DeleteOutlined";var s,d=o.forwardRef(l),f=t(4964),v=t(184),p=function(e){var n=e.onClick;return(0,v.jsx)(f.Z,{onClick:n,type:"primary",htmlType:"submit",icon:(0,v.jsx)(d,{})})},h=a.ZP.div(s||(s=(0,r.Z)(["\n  display: flex;\n  justify-content: space-between;\n  padding-bottom: 0.5em;\n"]))),m=function(e){var n=e.onDeleteButtonClick,t=e.text;return(0,v.jsxs)(h,{children:[(0,v.jsx)("span",{children:t}),(0,v.jsx)("span",{children:(0,v.jsx)(p,{onClick:n})})]})}},8920:function(e,n,t){t.d(n,{J:function(){return o}});var r=t(3766),a=t(1519),i=t(184),o=function(e){var n=e.typeId,t=e.onChange,o=e.value,u=e.allowClear,c=e.disabled,l=(0,a.L)().useGetTree({typeId:n}),s=l.isLoading,d=l.data;return(0,i.jsx)(r.Z,{treeData:d,allowClear:u,loading:s,disabled:c||!n,onChange:t,value:0!=o?o:void 0,dropdownStyle:{overflow:"auto"},treeDefaultExpandAll:!0})}},7338:function(e,n,t){t.d(n,{S:function(){return l}});var r=t(1933),a=t(3840),i=[{id:a.K.EXPENSE,name:"\u0420\u0430\u0441\u0445\u043e\u0434"},{id:a.K.INCOME,name:"\u0414\u043e\u0445\u043e\u0434"},{id:a.K.RETURN_EXPENSE,name:"\u0412\u043e\u0437\u0432\u0440\u0430\u0442 \u0440\u0430\u0441\u0445\u043e\u0434\u0430"},{id:a.K.RETURN_INCOME,name:"\u0412\u043e\u0437\u0432\u0440\u0430\u0442 \u0434\u043e\u0445\u043e\u0434\u0430"},{id:a.K.TRANSFER,name:"\u041f\u0435\u0440\u0435\u0432\u043e\u0434 \u043c\u0435\u0436\u0434\u0443 \u0441\u0432\u043e\u0438\u043c\u0438 \u0441\u0447\u0435\u0442\u0430\u043c\u0438"}],o=function(e){return(0,r.useQuery)(["transactionTypes",e],(function(){return function(e){return new Promise((function(n){n(e?i.filter((function(e){return e.id!==a.K.RETURN_EXPENSE&&e.id!==a.K.RETURN_INCOME})):i)}))}(!!e)}))},u=t(3570),c=t(184),l=function(e){var n=e.allowClear,t=e.value,r=e.hideReturns,a=e.disabled,i=e.onChange,l=o(r),s=l.isLoading,d=l.data;return(0,c.jsx)(u.P,{allowClear:n,loading:s,onChange:i,value:t,disabled:a,children:(null===d||void 0===d?void 0:d.length)&&(null===d||void 0===d?void 0:d.map((function(e){return(0,c.jsx)(u.$,{value:e.id,children:e.name},e.id)})))})}},9113:function(e,n,t){t.r(n),t.d(n,{CategoryDetailsPage:function(){return C},default:function(){return b}});var r=t(2791),a=t(6871),i=t(1519),o=t(1871),u=t(1413),c=t(9439),l=t(4829),s=t(135),d=t(4587),f=t(4964),v=t(1569),p=t(5461),h=t(8920),m=t(7338),y=t(184),g=function(e){var n=e.category,t=(0,i.L)().useItem,o=t("PUT",n.id),g=t("DELETE",n.id),C=(0,a.s0)(),b=l.Z.useForm(),x=(0,c.Z)(b,1)[0],E=n.typeId,Z=(0,r.useState)(E),k=(0,c.Z)(Z,2),I=k[0],O=k[1];return(0,y.jsxs)("div",{children:[(0,y.jsx)(p.p,{text:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",onDeleteButtonClick:function(){confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044e? \u041f\u0440\u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u0431\u0443\u0434\u0435\u0442 \u0441\u043a\u0440\u044b\u0442\u0430.")&&(g.mutate({id:n.id}),C(v._1.SETTINGS.CATEGORIES))}}),(0,y.jsxs)(l.Z,{name:"basic",labelCol:{span:8},layout:"vertical",form:x,wrapperCol:{span:16},initialValues:(0,u.Z)((0,u.Z)({},n),{},{isActive:null===n||void 0===n||!n.id||n.isActive,typeId:E}),onValuesChange:function(){O(x.getFieldValue("typeId"))},onFinish:function(e){o.mutate(e),C(v._1.SETTINGS.CATEGORIES)},autoComplete:"off",children:[(0,y.jsx)(l.Z.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"name",rules:[{message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",required:!0}],children:(0,y.jsx)(s.Z,{})}),(0,y.jsx)(l.Z.Item,{label:"\u0422\u0438\u043f",name:"typeId",rules:[{message:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0442\u0438\u043f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",required:!0}],children:(0,y.jsx)(m.S,{hideReturns:!0,disabled:!0})}),(0,y.jsx)(l.Z.Item,{label:"\u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0430\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",name:"parentCategoryId",children:(0,y.jsx)(h.J,{typeId:I,allowClear:!0})}),(0,y.jsx)(l.Z.Item,{label:"\u041f\u043e\u0440\u044f\u0434\u043e\u043a",name:"order",children:(0,y.jsx)(s.Z,{type:"number"})}),(0,y.jsx)(l.Z.Item,{name:"isActive",valuePropName:"checked",children:(0,y.jsx)(d.Z,{children:"\u0410\u043a\u0442\u0438\u0432\u043d\u0430"})}),(0,y.jsx)(l.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,y.jsx)(f.Z,{type:"primary",htmlType:"submit",disabled:o.isLoading,children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})})]}),o.isLoading&&(0,y.jsx)("div",{children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445..."})]})},C=function(){var e=(0,a.UO)().categoryId,n=(0,(0,i.L)().useGetOne)(e||""),t=n.isFetching,r=n.isError,u=n.data;return(0,y.jsxs)(y.Fragment,{children:[t&&(0,y.jsx)(o.a,{}),r&&!t&&(0,y.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"}),!t&&!r&&u&&(0,y.jsx)(g,{category:u})]})},b=C},1519:function(e,n,t){t.d(n,{L:function(){return m}});var r=t(5861),a=t(7757),i=t.n(a),o=t(1933),u=t(1413),c=t(5671),l=t(3144),s=t(2810),d=t(3840),f=t(4467),v=t(145),p=function(){function e(){var n=this;(0,c.Z)(this,e),this._localDataService=(0,f.X)(),this.create=function(e){return new Promise((function(t){var r,a,i,o=n._localDataService.categories;o.push({id:(0,s.Z)(),isActive:!e.isActive||e.isActive,mpath:"",name:e.name?e.name:"",order:e.order?e.order:0,parentCategoryId:null!==(r=e.parentCategory)&&void 0!==r&&r.id?e.parentCategory.id:null,typeId:null!==(a=e.type)&&void 0!==a&&a.id?null===(i=e.type)||void 0===i?void 0:i.id:d.K.EXPENSE}),n._localDataService.categories=o.sort((function(e,n){return e.order-n.order})),t()}))},this.delete=function(e){return new Promise((function(t,r){var a=n._localDataService.categories,i=a.findIndex((function(n){return n.id===e}));if(-1!==i){var o=n._localDataService.transactions.filter((function(n){return n.categoryId===e}));o.length?(alert("\u0421\u0447\u0435\u0442 \u0441\u0434\u0435\u043b\u0430\u043d \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u043c, \u0430 \u043d\u0435 \u0443\u0434\u0430\u043b\u0451\u043d, \u0442.\u043a. \u043f\u043e \u0441\u0447\u0435\u0442\u0443 \u0431\u044b\u043b\u0438 \u043d\u0430\u0439\u0434\u0435\u043d\u044b \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438. \n\u0414\u0430\u0442\u044b:\n"+o.map((function(e){return(0,v.E7)(e.dt)})).join("\n")),a[i].isActive=!1):(console.log("category delete",i),a.splice(i,1)),n._localDataService.categories=a,t()}else r("category delete, id not found:"+e)}))},this.getOne=function(e){return n._localDataService.categories.find((function(n){return n.id===e}))},this.getTree=function(e,t){return new Promise((function(r){var a=n._localDataService.categories.filter((function(n){var r=!0;if(e){var a=e;e===d.K.RETURN_EXPENSE&&(a=d.K.EXPENSE),e===d.K.RETURN_INCOME&&(a=d.K.INCOME),n.typeId!==a&&(r=!1)}return t||n.isActive||(r=!1),r}));r(a.filter((function(e){return null===e.parentCategoryId})).map((function(e){var t=a.filter((function(n){return e.id===n.parentCategoryId})).map((function(e){return n.transformCategoryToTreeItem(e)}));return(0,u.Z)((0,u.Z)({},n.transformCategoryToTreeItem(e)),{},{children:t})})))}))},this.transformCategoryToTreeItem=function(e){return{id:e.id,key:e.id,value:e.id,isActive:e.isActive,title:e.name}},this.update=function(e,t){return new Promise((function(r,a){var i=n._localDataService.categories,o=i.findIndex((function(n){return n.id===e}));if(-1===o)return console.error("categoryToUpdateIdx not found",e,t),void a();i.splice(o,1),i.push((0,u.Z)((0,u.Z)({},t),{},{id:e})),n._localDataService.categories=i.sort((function(e,n){return e.order-n.order})),r()}))}}return(0,l.Z)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();p.instance=void 0;var h="categories",m=function(){var e=(0,o.useQueryClient)(),n=p.getInstance();return{useCreate:function(){return(0,o.useMutation)((function(e){return n.create(e)}),{onSuccess:function(){e.invalidateQueries(h)}})},useGetTree:function(e){var t=e.typeId,r=e.showHidden;return(0,o.useQuery)([h,"tree",t,r],(function(){return n.getTree(t,r)}))},useGetOne:function(e){return(0,o.useQuery)([h,e],(function(){return n.getOne(e)}),{enabled:!!e})},useItem:function(t,a,u){return(0,o.useMutation)((function(e){return"PUT"===t?n.update(a,e):n.delete(a)}),{onSuccess:function(){var n=(0,r.Z)(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("useItem onSuccess",t),n.next=3,e.cancelQueries(h);case 3:e.invalidateQueries([h,a]),e.invalidateQueries(h),u&&u();case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()})}}}},4587:function(e,n,t){t.d(n,{Z:function(){return P}});var r=t(4942),a=t(7462),i=t(2791),o=t(1694),u=t.n(o),c=t(4925),l=t(1413),s=t(5671),d=t(3144),f=t(136),v=t(8557),p=function(e){(0,f.Z)(t,e);var n=(0,v.Z)(t);function t(e){var r;(0,s.Z)(this,t),(r=n.call(this,e)).handleChange=function(e){var n=r.props,t=n.disabled,a=n.onChange;t||("checked"in r.props||r.setState({checked:e.target.checked}),a&&a({target:(0,l.Z)((0,l.Z)({},r.props),{},{checked:e.target.checked}),stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},nativeEvent:e.nativeEvent}))},r.saveInput=function(e){r.input=e};var a="checked"in e?e.checked:e.defaultChecked;return r.state={checked:a},r}return(0,d.Z)(t,[{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e,n=this.props,t=n.prefixCls,o=n.className,l=n.style,s=n.name,d=n.id,f=n.type,v=n.disabled,p=n.readOnly,h=n.tabIndex,m=n.onClick,y=n.onFocus,g=n.onBlur,C=n.onKeyDown,b=n.onKeyPress,x=n.onKeyUp,E=n.autoFocus,Z=n.value,k=n.required,I=(0,c.Z)(n,["prefixCls","className","style","name","id","type","disabled","readOnly","tabIndex","onClick","onFocus","onBlur","onKeyDown","onKeyPress","onKeyUp","autoFocus","value","required"]),O=Object.keys(I).reduce((function(e,n){return"aria-"!==n.substr(0,5)&&"data-"!==n.substr(0,5)&&"role"!==n||(e[n]=I[n]),e}),{}),j=this.state.checked,w=u()(t,o,(e={},(0,r.Z)(e,"".concat(t,"-checked"),j),(0,r.Z)(e,"".concat(t,"-disabled"),v),e));return i.createElement("span",{className:w,style:l},i.createElement("input",(0,a.Z)({name:s,id:d,type:f,required:k,readOnly:p,disabled:v,tabIndex:h,className:"".concat(t,"-input"),checked:!!j,onClick:m,onFocus:y,onBlur:g,onKeyUp:x,onKeyDown:C,onKeyPress:b,onChange:this.handleChange,autoFocus:E,ref:this.saveInput,value:Z},O)),i.createElement("span",{className:"".concat(t,"-inner")}))}}],[{key:"getDerivedStateFromProps",value:function(e,n){return"checked"in e?(0,l.Z)((0,l.Z)({},n),{},{checked:e.checked}):null}}]),t}(i.Component);p.defaultProps={prefixCls:"rc-checkbox",className:"",style:{},type:"checkbox",defaultChecked:!1,onFocus:function(){},onBlur:function(){},onChange:function(){},onKeyDown:function(){},onKeyPress:function(){},onKeyUp:function(){}};var h=p,m=t(3433),y=t(9439),g=t(1818),C=t(3785),b=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},x=i.createContext(null),E=function(e,n){var t=e.defaultValue,o=e.children,c=e.options,l=void 0===c?[]:c,s=e.prefixCls,d=e.className,f=e.style,v=e.onChange,p=b(e,["defaultValue","children","options","prefixCls","className","style","onChange"]),h=i.useContext(C.E_),E=h.getPrefixCls,Z=h.direction,k=i.useState(p.value||t||[]),I=(0,y.Z)(k,2),O=I[0],j=I[1],w=i.useState([]),N=(0,y.Z)(w,2),P=N[0],T=N[1];i.useEffect((function(){"value"in p&&j(p.value||[])}),[p.value]);var K=function(){return l.map((function(e){return"string"===typeof e||"number"===typeof e?{label:e,value:e}:e}))},_=E("checkbox",s),D="".concat(_,"-group"),R=(0,g.Z)(p,["value","disabled"]);l&&l.length>0&&(o=K().map((function(e){return i.createElement(S,{prefixCls:_,key:e.value.toString(),disabled:"disabled"in e?e.disabled:p.disabled,value:e.value,checked:-1!==O.indexOf(e.value),onChange:e.onChange,className:"".concat(D,"-item"),style:e.style},e.label)})));var A={toggleOption:function(e){var n=O.indexOf(e.value),t=(0,m.Z)(O);-1===n?t.push(e.value):t.splice(n,1),"value"in p||j(t);var r=K();null===v||void 0===v||v(t.filter((function(e){return-1!==P.indexOf(e)})).sort((function(e,n){return r.findIndex((function(n){return n.value===e}))-r.findIndex((function(e){return e.value===n}))})))},value:O,disabled:p.disabled,name:p.name,registerValue:function(e){T((function(n){return[].concat((0,m.Z)(n),[e])}))},cancelValue:function(e){T((function(n){return n.filter((function(n){return n!==e}))}))}},M=u()(D,(0,r.Z)({},"".concat(D,"-rtl"),"rtl"===Z),d);return i.createElement("div",(0,a.Z)({className:M,style:f},R,{ref:n}),i.createElement(x.Provider,{value:A},o))},Z=i.forwardRef(E),k=i.memo(Z),I=t(4824),O=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},j=function(e,n){var t,o=e.prefixCls,c=e.className,l=e.children,s=e.indeterminate,d=void 0!==s&&s,f=e.style,v=e.onMouseEnter,p=e.onMouseLeave,m=e.skipGroup,y=void 0!==m&&m,g=O(e,["prefixCls","className","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup"]),b=i.useContext(C.E_),E=b.getPrefixCls,Z=b.direction,k=i.useContext(x),j=i.useRef(g.value);i.useEffect((function(){null===k||void 0===k||k.registerValue(g.value),(0,I.Z)("checked"in g||!!k||!("value"in g),"Checkbox","`value` is not a valid prop, do you mean `checked`?")}),[]),i.useEffect((function(){if(!y)return g.value!==j.current&&(null===k||void 0===k||k.cancelValue(j.current),null===k||void 0===k||k.registerValue(g.value),j.current=g.value),function(){return null===k||void 0===k?void 0:k.cancelValue(g.value)}}),[g.value]);var w=E("checkbox",o),S=(0,a.Z)({},g);k&&!y&&(S.onChange=function(){g.onChange&&g.onChange.apply(g,arguments),k.toggleOption&&k.toggleOption({label:l,value:g.value})},S.name=k.name,S.checked=-1!==k.value.indexOf(g.value),S.disabled=g.disabled||k.disabled);var N=u()((t={},(0,r.Z)(t,"".concat(w,"-wrapper"),!0),(0,r.Z)(t,"".concat(w,"-rtl"),"rtl"===Z),(0,r.Z)(t,"".concat(w,"-wrapper-checked"),S.checked),(0,r.Z)(t,"".concat(w,"-wrapper-disabled"),S.disabled),t),c),P=u()((0,r.Z)({},"".concat(w,"-indeterminate"),d));return i.createElement("label",{className:N,style:f,onMouseEnter:v,onMouseLeave:p},i.createElement(h,(0,a.Z)({},S,{prefixCls:w,className:P,ref:n})),void 0!==l&&i.createElement("span",null,l))},w=i.forwardRef(j);w.displayName="Checkbox";var S=w,N=S;N.Group=k,N.__ANT_CHECKBOX=!0;var P=N}}]);
//# sourceMappingURL=113.944ec990.chunk.js.map