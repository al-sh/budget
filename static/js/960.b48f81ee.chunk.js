"use strict";(self.webpackChunkbudget_react=self.webpackChunkbudget_react||[]).push([[960],{3806:function(n,e,t){t.d(e,{z:function(){return o}});var r=t(1413),i=t(4964),a=t(184),o=function(n){var e=Object.assign({},n),t={background:"primary"===e.type?"linear-gradient(180deg, #008f8c 0%, #0fc2c0 100%)":"",border:"none"};return(0,a.jsx)(i.Z,(0,r.Z)((0,r.Z)({},e),{},{style:t}))}},5734:function(n,e,t){t.d(e,{M:function(){return s}});var r=t(3506),i=(t(3333),t(8163)),a=t(1049),o=t(184),s=function(n){var e=n.withTime,t=n.onChange,s=n.value,c=n.placeholder;return(0,o.jsx)(r.Z,{format:e?a.b.dateMoment.withTime:a.b.dateMoment.short,locale:i.Z,showTime:e,placeholder:c||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0430\u0442\u0443",value:s,onChange:t})}},9921:function(n,e,t){t.d(e,{V:function(){return a}});var r,i=t(168),a=t(5751).ZP.div(r||(r=(0,i.Z)(["\n  height: 64px;\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  background: linear-gradient(180deg, #008f8c 0%, #0fc2c0 100%);\n  border-radius: 0px 0px 5px 5px;\n  padding: 12px;\n"])))},3098:function(n,e,t){t.d(e,{G:function(){return a}});var r,i=t(168),a=t(5751).ZP.div(r||(r=(0,i.Z)(["\n  font-weight: 700;\n  font-size: 16px;\n  line-height: 19px;\n  color: ",";\n"])),(function(n){return n.theme.text.header}))},3570:function(n,e,t){t.d(e,{$:function(){return o},P:function(){return a}});var r=t(6818),i=t(184),a=function(n){var e=n.allowClear,t=n.children,a=n.disabled,o=n.loading,s=n.value,c=n.onChange;return(0,i.jsx)(r.Z,{allowClear:e,disabled:a,loading:o,value:0!=s?s:void 0,onChange:c,children:t})},o=function(n){var e=n.children;return(0,i.jsx)(r.Z.Option,{children:e})}},7556:function(n,e,t){t.d(e,{L:function(){return v}});var r,i=t(168),a=t(5751),o=t(2791),s=["title","titleId"];function c(){return c=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},c.apply(this,arguments)}function l(n,e){if(null==n)return{};var t,r,i=function(n,e){if(null==n)return{};var t,r,i={},a=Object.keys(n);for(r=0;r<a.length;r++)t=a[r],e.indexOf(t)>=0||(i[t]=n[t]);return i}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(r=0;r<a.length;r++)t=a[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function d(n,e){var t=n.title,i=n.titleId,a=l(n,s);return o.createElement("svg",c({width:30,height:24,viewBox:"0 0 30 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:e,"aria-labelledby":i},a),t?o.createElement("title",{id:i},t):null,r||(r=o.createElement("path",{d:"M15 0.480003C13.815 0.480003 12.82 1.30251 12.5325 2.4H0.920002C0.690005 2.3975 0.475003 2.5175 0.357499 2.7175C0.242497 2.9175 0.242497 3.1625 0.357499 3.3625C0.474997 3.5625 0.689998 3.6825 0.920002 3.68H12.5325C12.82 4.77749 13.815 5.6 15 5.6C16.185 5.6 17.18 4.77749 17.4675 3.68H29.08C29.31 3.6825 29.525 3.5625 29.6425 3.3625C29.7575 3.1625 29.7575 2.9175 29.6425 2.7175C29.525 2.5175 29.31 2.3975 29.08 2.4H17.4675C17.18 1.30251 16.185 0.480003 15 0.480003V0.480003ZM15 1.76C15.695 1.76 16.2425 2.295 16.2725 2.98251C16.27 3.02 16.27 3.06 16.2725 3.1C16.2425 3.785 15.695 4.32 15 4.32C14.305 4.32 13.7575 3.785 13.7275 3.0975C13.73 3.06 13.73 3.02 13.7275 2.98C13.7575 2.295 14.305 1.76 15 1.76ZM23.96 9.44C22.775 9.44 21.78 10.2625 21.4925 11.36H0.920002C0.690005 11.3575 0.475003 11.4775 0.357499 11.6775C0.242497 11.8775 0.242497 12.1225 0.357499 12.3225C0.474997 12.5225 0.689998 12.6425 0.920002 12.64H21.4925C21.78 13.7375 22.775 14.56 23.96 14.56C25.145 14.56 26.14 13.7375 26.4275 12.64H29.08C29.31 12.6425 29.525 12.5225 29.6425 12.3225C29.7575 12.1225 29.7575 11.8775 29.6425 11.6775C29.525 11.4775 29.31 11.3575 29.08 11.36H26.4275C26.14 10.2625 25.145 9.44 23.96 9.44ZM23.96 10.72C24.655 10.72 25.2025 11.255 25.2325 11.9425C25.23 11.98 25.23 12.02 25.2325 12.06C25.2025 12.745 24.655 13.28 23.96 13.28C23.265 13.28 22.7175 12.745 22.6875 12.0575C22.69 12.02 22.69 11.98 22.6875 11.94C22.7175 11.255 23.265 10.72 23.96 10.72ZM7.96 18.4C6.775 18.4 5.78 19.2225 5.4925 20.32H0.920002C0.690005 20.3175 0.475003 20.4375 0.357499 20.6375C0.242497 20.8375 0.242497 21.0825 0.357499 21.2825C0.474997 21.4825 0.689998 21.6025 0.920002 21.6H5.4925C5.78 22.6975 6.775 23.52 7.96 23.52C9.145 23.52 10.14 22.6975 10.4275 21.6H29.08C29.31 21.6025 29.525 21.4825 29.6425 21.2825C29.7575 21.0825 29.7575 20.8375 29.6425 20.6375C29.525 20.4375 29.31 20.3175 29.08 20.32H10.4275C10.14 19.2225 9.145 18.4 7.96 18.4ZM7.96 19.68C8.655 19.68 9.2025 20.215 9.2325 20.9025C9.23 20.94 9.23 20.98 9.2325 21.02C9.2025 21.705 8.655 22.24 7.96 22.24C7.265 22.24 6.7175 21.705 6.6875 21.0175C6.69 20.98 6.69 20.94 6.6875 20.9C6.71751 20.215 7.265 19.68 7.96 19.68Z",fill:"white"})))}var u,h,f=o.forwardRef(d),p=(t.p,t(184)),m=a.ZP.div(u||(u=(0,i.Z)(["\n  cursor: pointer;\n  position: relative;\n"]))),g=a.ZP.span(h||(h=(0,i.Z)(["\n  position: absolute;\n  height: 16px;\n  width: 16px;\n  padding-left: 4px;\n  bottom: 0px;\n  right: -5px;\n  border-radius: 8px;\n  line-height: 18px;\n  background-color: ",";\n  color: ",";\n"])),(function(n){return n.theme.background.main}),(function(n){return n.theme.text.active})),v=function(n){var e=n.showFilters,t=n.onClick,r=n.filtersCount;return(0,p.jsxs)(m,{children:[(0,p.jsx)(f,{onClick:t,children:e?"\u0421\u043a\u0440\u044b\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"}),!!r&&(0,p.jsx)(g,{children:r})]})}},4034:function(n,e,t){t.d(e,{X:function(){return o}});var r=t(7583),i=t(3570),a=t(184),o=function(n){var e=n.allowClear,t=n.value,o=n.onChange,s=(0,r.x)().useGetAccountsList(!1),c=s.isLoading,l=s.data;return(0,a.jsx)(i.P,{loading:c,allowClear:e,value:t,onChange:o,children:null===l||void 0===l?void 0:l.map((function(n){return(0,a.jsx)(i.$,{value:n.id,children:n.name},n.id)}))})}},8960:function(n,e,t){t.r(e),t.d(e,{StatisticsPage:function(){return en},default:function(){return tn}});var r,i,a,o,s=t(1413),c=t(9439),l=t(3006),d=t(2426),u=t.n(d),h=t(2791),f=t(1933),p=t(336),m=t(1049),g=t(6987),v="statistics",x=function(){var n=(0,g.a)();return{useGetTree:function(e){var t=e.dateFrom,r=e.dateEnd,i=e.typeId,a=e.showHidden,o={};return null!==t&&void 0!==t&&t.isValid()&&(o.dateFrom=t.format(m.b.dateMoment.short)),null!==r&&void 0!==r&&r.isValid()&&(o.dateEnd=r.format(m.b.dateMoment.short)),o.showHidden=a?"1":"0",o.typeId=String(i),(0,f.useQuery)([v,"tree",JSON.stringify(o)],(function(){return n.send({endpoint:p.q.STATISTICS+"/tree",method:"GET",query:o})}))},useGraph:function(e){var t=e.dateFrom,r=e.dateEnd,i=e.typeId,a=e.showHidden,o={};null!==t&&void 0!==t&&t.isValid()&&(o.dateFrom=t.format(m.b.dateMoment.short)),null!==r&&void 0!==r&&r.isValid()&&(o.dateEnd=r.format(m.b.dateMoment.short)),o.showHidden=a?"1":"0",o.typeId=String(i);var s=e.categoryIds;return s&&(o.categoryIds=s.join(",")),(0,f.useQuery)([v,"graph",JSON.stringify(o)],(function(){return n.send({endpoint:p.q.STATISTICS+"/graph",method:"GET",query:o})}))}}},C=t(3840),j=t(7556),y=t(1871),Z=t(9921),b=t(3098),w=t(168),S=t(6883),I=t(5751),T=t(145),k=t(184),M=I.ZP.div(r||(r=(0,w.Z)(["\n  margin-bottom: 1em;\n\n  .ant-tree .ant-tree-node-content-wrapper {\n    cursor: default;\n  }\n\n  .ant-tree-list {\n    background-color: ",";\n\n    .ant-tree-switcher {\n      color: ",";\n    }\n  }\n"])),(function(n){return n.theme.background.main}),(function(n){return n.theme.text.primary})),E=I.ZP.div(i||(i=(0,w.Z)(["\n  background-color: ",";\n"])),(function(n){return n.theme.background.main})),F=I.ZP.span(a||(a=(0,w.Z)(["\n  display: inline-block;\n  width: 150px;\n  color: ",";\n"])),(function(n){var e=n.theme;return n.active?e.text.primary:e.text.inactive})),H=I.ZP.span(o||(o=(0,w.Z)(["\n  margin-left: 10px;\n  color: green;\n"]))),P=function(n){var e=n.categoriesTree,t=n.onSelect;return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(M,{children:(0,k.jsx)(S.Z,{treeData:e,selectable:!0,multiple:!0,onSelect:function(n){return t&&t(n.map((function(n){return String(n)})))},titleRender:function(n){return(0,k.jsxs)(E,{children:[(0,k.jsx)(F,{active:!!n.isActive,children:n.title}),(0,k.jsxs)(H,{children:[(0,T.lb)(n.totalAmount)," (",(0,T.T3)(n.share),"%)"]})]})}})})})},O=t(4829),A=t(4034),G=t(3806),D=t(4587),V=(t(3333),function(n){var e=n.onChange,t=n.value;return(0,k.jsx)(D.Z,{checked:t,onChange:e})}),N=t(5734),L=function(n){var e=n.params,t=n.onClear,r=n.onFinish,i=O.Z.useForm(),a=(0,c.Z)(i,1)[0],o=(0,h.useState)(!1),s=(0,c.Z)(o,2),l=s[0],d=s[1];return(0,k.jsx)("div",{children:(0,k.jsxs)(O.Z,{name:"StatFilters",form:a,onValuesChange:function(){d(a.getFieldsError().filter((function(n){return n.errors.length})).length>0)},layout:"horizontal",labelAlign:"left",initialValues:e,onFinish:function(n){r(n)},autoComplete:"off",children:[(0,k.jsxs)("div",{style:{marginTop:20,display:"flex",alignItems:"baseline"},children:[(0,k.jsx)(O.Z.Item,{name:"dateFrom",style:{display:"inline-block"},children:(0,k.jsx)(N.M,{placeholder:"\u041d\u0430\u0447\u0430\u043b\u043e \u043f\u0435\u0440\u0438\u043e\u0434\u0430"})}),(0,k.jsx)("span",{style:{margin:"0 12px 0 12px"},children:"-"}),(0,k.jsx)(O.Z.Item,{name:"dateEnd",style:{display:"inline-block"},children:(0,k.jsx)(N.M,{placeholder:"\u041a\u043e\u043d\u0435\u0446 \u043f\u0435\u0440\u0438\u043e\u0434\u0430"})}),(0,k.jsx)(G.z,{onClick:function(){a.setFieldsValue({dateFrom:u()("20220101"),dateEnd:u()("20221130")})},children:"\u0413\u043e\u0434"}),(0,k.jsx)(G.z,{onClick:function(){a.setFieldsValue({dateFrom:u()("20220701"),dateEnd:u()("20221130")})},children:"\u041f\u043e\u043b\u0443\u0433\u043e\u0434\u0438\u0435"})]}),(0,k.jsx)(O.Z.Item,{label:"\u0421\u0447\u0435\u0442",name:"accountId",children:(0,k.jsx)(A.X,{allowClear:!0})}),(0,k.jsx)(O.Z.Item,{label:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043a\u0440\u044b\u0442\u044b\u0435",name:"showHidden",children:(0,k.jsx)(V,{onChange:function(n){a.setFieldsValue({showHidden:n.target.checked})}})}),(0,k.jsxs)(O.Z.Item,{wrapperCol:{offset:8,span:16},children:[(0,k.jsx)(G.z,{type:"link",onClick:function(){t()},children:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"}),(0,k.jsx)(G.z,{type:"primary",htmlType:"submit",disabled:l,children:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c"})]})]})})},Y=t(3433),z=t(4942),q=t(601),K=t(5847),R=t(2839),X=t(466),B=t(2891),U=t(5667),_=t(4296),J=t(3628);function Q(){for(var n="#",e=0;e<6;e++)n+="0123456789ABCDEF"[Math.floor(16*Math.random())];return n}var $=function(n){for(var e=n.statCategories,t=e.map((function(n){return function(n){return n.data.map((function(e){return(0,z.Z)({name:e.period},n.category.name,e.amount/100)}))}(n)})).flat(),r=new Map,i=0;i<t.length;i++){var a=t[i].name,o=r.get(a);o?r.set(a,(0,s.Z)((0,s.Z)({},o),t[i])):r.set(a,t[i])}var c=(0,Y.Z)(r.values()),l=e.map((function(n){return n.category.name}));return(0,k.jsx)("div",{style:{height:600,marginLeft:-30},children:(0,k.jsx)(q.h,{width:"100%",height:"100%",children:(0,k.jsxs)(K.w,{height:600,data:c,margin:{top:5,right:30,left:20,bottom:5},children:[(0,k.jsx)(R.q,{strokeDasharray:"3 3"}),(0,k.jsx)(X.K,{dataKey:"name"}),(0,k.jsx)(B.B,{tickFormatter:function(n){return(0,T.WA)(n)}}),(0,k.jsx)(U.u,{}),(0,k.jsx)(_.D,{}),l.map((function(n){return(0,k.jsx)(J.x,{type:"monotone",dataKey:n,stroke:Q()},n)}))]})})})},W=function(n){var e=n.statCategories,t=(0,h.useState)(!1),r=(0,c.Z)(t,2),i=r[0],a=r[1];return(0,k.jsxs)("div",{children:[!i&&(0,k.jsx)(G.z,{onClick:function(){a(!0)},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435"}),(0,k.jsx)("div",{children:i&&(null===e||void 0===e?void 0:e.length)>0&&(null===e||void 0===e?void 0:e.map((function(n){return(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{children:n.category.name}),(0,k.jsx)("div",{children:n.data.map((function(n){return(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{children:n.period}),(0,k.jsx)("span",{style:{marginLeft:20},children:(0,T.lb)(n.amount)})]},n.period)}))})]},n.category.id)})))})]})},nn=function(n){var e=n.filterParams,t=n.selectedCategories,r=(0,x().useGraph)((0,s.Z)((0,s.Z)({},e),{},{categoryIds:t})),i=r.isLoading,a=r.isError,o=r.data;return i?(0,k.jsx)(y.a,{}):a?(0,k.jsx)("div",{children:"useGraph error"}):o?(0,k.jsxs)("div",{children:[(0,k.jsx)($,{statCategories:o}),(0,k.jsx)(W,{statCategories:o})]}):(0,k.jsx)(k.Fragment,{})},en=function(){var n=(0,h.useState)(!1),e=(0,c.Z)(n,2),t=e[0],r=e[1],i=new Date;i.setMonth(i.getMonth()-6),i.setDate(1);var a=new Date;a.setDate(0);var o=(0,h.useState)({typeId:C.K.EXPENSE,showHidden:!1,dateFrom:u()(i),dateEnd:u()(a)}),d=(0,c.Z)(o,2),f=d[0],p=d[1],m=(0,h.useState)(void 0),g=(0,c.Z)(m,2),v=g[0],w=g[1],S=(0,x().useGetTree)(f),I=S.isLoading,T=S.isError,M=S.data,E=0;for(var F in f)"typeId"!==F&&f[F]&&E++;return T?(0,k.jsx)(k.Fragment,{children:"Error"}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Z.V,{children:[(0,k.jsx)(b.G,{children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c"}),(0,k.jsx)(j.L,{onClick:function(){r(!t)},showFilters:t,filtersCount:E})]}),t&&(0,k.jsx)(L,{params:f,onClear:function(){r(!1),p((0,s.Z)({},{}))},onFinish:function(n){r(!1),p((0,s.Z)((0,s.Z)({},f),n))}}),(0,k.jsxs)(l.Z,{activeKey:String(f.typeId),onChange:function(n){p((0,s.Z)((0,s.Z)({},f),{},{typeId:parseInt(n)}))},children:[(0,k.jsx)(l.Z.TabPane,{tab:"\u0420\u0430\u0441\u0445\u043e\u0434\u044b"},String(C.K.EXPENSE)),(0,k.jsx)(l.Z.TabPane,{tab:"\u0414\u043e\u0445\u043e\u0434\u044b"},String(C.K.INCOME))]}),I&&(0,k.jsx)(y.a,{}),M&&!I&&(0,k.jsx)(P,{categoriesTree:M,onSelect:function(n){return w(n)}}),v&&(0,k.jsx)(nn,{filterParams:f,selectedCategories:v})]})},tn=en},336:function(n,e,t){t.d(e,{q:function(){return r}});var r={ACCOUNTS:"accounts",AUTH:"auth",CATEGORIES:"categories",SYNC:"sync",STATISTICS:"statistics",TRANSACTIONS:"transactions"}},1049:function(n,e,t){t.d(e,{b:function(){return r}});var r={date:{short:"yyyy-MM-dd",withTime:"YYYY-MM-dd HH:mm",time:"HH:mm"},dateMoment:{short:"yyyy-MM-DD",withTime:"YYYY-MM-DD HH:mm"}}},6987:function(n,e,t){t.d(e,{a:function(){return f}});var r=t(5861),i=t(5671),a=t(3144),o=t(7757),s=t.n(o),c=t(4569),l=t.n(c),d=t(4674),u=t(1569),h=function(){function n(){var e=this;(0,i.Z)(this,n),this.path="".concat(window.location.origin,"/api"),this.send=function(){var n=(0,r.Z)(s().mark((function n(t){var r,i,a,o,c,h,f;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.endpoint,i=t.method,a=t.data,o=t.query,c=t.isFile,h="".concat(e.path,"/").concat(r),f={Auth:(0,d.c)().getItem("token"),UserId:(0,d.c)().getItem("userId")},c&&(f["Content-Type"]="multipart/form-data"),n.abrupt("return",new Promise((function(n,e){l()({data:a,headers:f,method:i,params:o,url:h}).then((function(e){n(e.data)})).catch((function(n){var t;console.log(n.response),n.response&&401===(null===(t=n.response)||void 0===t?void 0:t.status)&&(console.log("redirected to login"),window.location.href="".concat(window.location.origin).concat(u._1.SETTINGS.LOGIN)),e(n)}))})));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),console.log("ApiService create. path:",this.path)}return(0,a.Z)(n,null,[{key:"getInstance",value:function(){return n.instance||(console.log("ApiService - create"),n.instance=new n),n.instance}}]),n}();h.instance=void 0;var f=function(){return h.getInstance()}}}]);
//# sourceMappingURL=960.b48f81ee.chunk.js.map